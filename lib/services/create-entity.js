"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.createEntity = void 0;

var _rxjs = require("rxjs");

var _operators = require("rxjs/operators");

var _helpers = require("../helpers");

const createEntity = ({
  entity,
  repository,
  schema,
  validatePermission
}) => (0, _helpers.validateSchema)(schema)(entity).pipe((0, _operators.switchMap)(e => validatePermission ? validatePermission(e).pipe((0, _operators.map)(() => e)) : (0, _rxjs.of)(e)), (0, _operators.switchMap)(repository.create));

exports.createEntity = createEntity;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9zZXJ2aWNlcy9jcmVhdGUtZW50aXR5LnRzIl0sIm5hbWVzIjpbImNyZWF0ZUVudGl0eSIsImVudGl0eSIsInJlcG9zaXRvcnkiLCJzY2hlbWEiLCJ2YWxpZGF0ZVBlcm1pc3Npb24iLCJwaXBlIiwiZSIsImNyZWF0ZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUlBOztBQUNBOztBQUNBOztBQUVPLE1BQU1BLFlBS08sR0FBRyxDQUFDO0FBQUNDLEVBQUFBLE1BQUQ7QUFBU0MsRUFBQUEsVUFBVDtBQUFxQkMsRUFBQUEsTUFBckI7QUFBNkJDLEVBQUFBO0FBQTdCLENBQUQsS0FDckIsNkJBQThCRCxNQUE5QixFQUFzQ0YsTUFBdEMsRUFBOENJLElBQTlDLENBQ0UsMEJBQVdDLENBQUQsSUFBUUYsa0JBQWtCLEdBQUdBLGtCQUFrQixDQUFDRSxDQUFELENBQWxCLENBQXNCRCxJQUF0QixDQUEyQixvQkFBSSxNQUFNQyxDQUFWLENBQTNCLENBQUgsR0FBOEMsY0FBR0EsQ0FBSCxDQUFsRixDQURGLEVBRUUsMEJBQVVKLFVBQVUsQ0FBQ0ssTUFBckIsQ0FGRixDQU5LIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUge09ic2VydmFibGV9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHR5cGUge0VudGl0eSwgV3JpdGVSZXBvc2l0b3J5fSBmcm9tICdAbGliL2ludGVyZmFjZXMnO1xuaW1wb3J0IHR5cGUge1NjaGVtYU9mfSBmcm9tICd5dXAnO1xuXG5pbXBvcnQge29mfSBmcm9tICdyeGpzJztcbmltcG9ydCB7c3dpdGNoTWFwLCBtYXB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7dmFsaWRhdGVTY2hlbWF9IGZyb20gJ0BsaWIvaGVscGVycyc7XG5cbmV4cG9ydCBjb25zdCBjcmVhdGVFbnRpdHk6IDxJZCA9IHN0cmluZywgRSBleHRlbmRzIEVudGl0eTxJZD4gPSBFbnRpdHk8SWQ+PihwYXJhbXM6IHtcbiAgZW50aXR5OiBPbWl0PEUsICdpZCc+ICYge2lkPzogSWR9O1xuICByZXBvc2l0b3J5OiBXcml0ZVJlcG9zaXRvcnk8SWQsIEU+O1xuICBzY2hlbWE6IFNjaGVtYU9mPHVua25vd24+O1xuICB2YWxpZGF0ZVBlcm1pc3Npb24/OiAoZW50aXR5OiBPbWl0PEUsICdpZCc+ICYge2lkPzogSWR9KSA9PiBPYnNlcnZhYmxlPHZvaWQ+O1xufSkgPT4gT2JzZXJ2YWJsZTxJZD4gPSAoe2VudGl0eSwgcmVwb3NpdG9yeSwgc2NoZW1hLCB2YWxpZGF0ZVBlcm1pc3Npb259KSA9PlxuICB2YWxpZGF0ZVNjaGVtYTx0eXBlb2YgZW50aXR5PihzY2hlbWEpKGVudGl0eSkucGlwZShcbiAgICBzd2l0Y2hNYXAoKGUpID0+ICh2YWxpZGF0ZVBlcm1pc3Npb24gPyB2YWxpZGF0ZVBlcm1pc3Npb24oZSkucGlwZShtYXAoKCkgPT4gZSkpIDogb2YoZSkpKSxcbiAgICBzd2l0Y2hNYXAocmVwb3NpdG9yeS5jcmVhdGUpLFxuICApO1xuIl19
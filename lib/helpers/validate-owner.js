"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.validateOwner = void 0;

var _errors = require("../errors");

var _validateAuthenticatedUser = require("./validate-authenticated-user");

const validateOwner = user => entity => {
  (0, _validateAuthenticatedUser.validateAuthenticatedUser)(user);

  if (entity.createdBy && user && user.id === entity.createdBy) {
    return entity;
  }

  throw new _errors.ForbiddenError('User must be the owner');
};

exports.validateOwner = validateOwner;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9oZWxwZXJzL3ZhbGlkYXRlLW93bmVyLnRzIl0sIm5hbWVzIjpbInZhbGlkYXRlT3duZXIiLCJ1c2VyIiwiZW50aXR5IiwiY3JlYXRlZEJ5IiwiaWQiLCJGb3JiaWRkZW5FcnJvciJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUNBOztBQUNBOztBQUVPLE1BQU1BLGFBQWEsR0FDdkJDLElBQUQsSUFDaUNDLE1BQWpDLElBQWtEO0FBQ2hELDREQUEwQkQsSUFBMUI7O0FBQ0EsTUFBSUMsTUFBTSxDQUFDQyxTQUFQLElBQW9CRixJQUFwQixJQUE0QkEsSUFBSSxDQUFDRyxFQUFMLEtBQVlGLE1BQU0sQ0FBQ0MsU0FBbkQsRUFBOEQ7QUFDNUQsV0FBT0QsTUFBUDtBQUNEOztBQUNELFFBQU0sSUFBSUcsc0JBQUosQ0FBbUIsd0JBQW5CLENBQU47QUFDRCxDQVJJIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUge0F1dGhVc2VyfSBmcm9tICcuLi9pbnRlcmZhY2VzJztcbmltcG9ydCB7Rm9yYmlkZGVuRXJyb3J9IGZyb20gJy4uL2Vycm9ycyc7XG5pbXBvcnQge3ZhbGlkYXRlQXV0aGVudGljYXRlZFVzZXJ9IGZyb20gJy4vdmFsaWRhdGUtYXV0aGVudGljYXRlZC11c2VyJztcblxuZXhwb3J0IGNvbnN0IHZhbGlkYXRlT3duZXIgPVxuICAodXNlcj86IEF1dGhVc2VyKSA9PlxuICA8VCBleHRlbmRzIHtjcmVhdGVkQnk/OiBzdHJpbmd9PihlbnRpdHk6IFQpOiBUID0+IHtcbiAgICB2YWxpZGF0ZUF1dGhlbnRpY2F0ZWRVc2VyKHVzZXIpO1xuICAgIGlmIChlbnRpdHkuY3JlYXRlZEJ5ICYmIHVzZXIgJiYgdXNlci5pZCA9PT0gZW50aXR5LmNyZWF0ZWRCeSkge1xuICAgICAgcmV0dXJuIGVudGl0eTtcbiAgICB9XG4gICAgdGhyb3cgbmV3IEZvcmJpZGRlbkVycm9yKCdVc2VyIG11c3QgYmUgdGhlIG93bmVyJyk7XG4gIH07XG4iXX0=
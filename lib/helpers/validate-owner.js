"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.validateOwner = void 0;

var _apolloServer = require("apollo-server");

var _validateAuthenticatedUser = require("./validate-authenticated-user");

const validateOwner = user => entity => {
  (0, _validateAuthenticatedUser.validateAuthenticatedUser)(user);

  if (entity.createdBy && user && user.id === entity.createdBy) {
    return entity;
  }

  throw new _apolloServer.ForbiddenError('User must be the owner');
};

exports.validateOwner = validateOwner;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9oZWxwZXJzL3ZhbGlkYXRlLW93bmVyLnRzIl0sIm5hbWVzIjpbInZhbGlkYXRlT3duZXIiLCJ1c2VyIiwiZW50aXR5IiwiY3JlYXRlZEJ5IiwiaWQiLCJGb3JiaWRkZW5FcnJvciJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUVBOztBQUNBOztBQUVPLE1BQU1BLGFBQWEsR0FBSUMsSUFBRCxJQUFzREMsTUFBakMsSUFBa0Q7QUFDbEcsNERBQTBCRCxJQUExQjs7QUFDQSxNQUFJQyxNQUFNLENBQUNDLFNBQVAsSUFBb0JGLElBQXBCLElBQTRCQSxJQUFJLENBQUNHLEVBQUwsS0FBWUYsTUFBTSxDQUFDQyxTQUFuRCxFQUE4RDtBQUM1RCxXQUFPRCxNQUFQO0FBQ0Q7O0FBQ0QsUUFBTSxJQUFJRyw0QkFBSixDQUFtQix3QkFBbkIsQ0FBTjtBQUNELENBTk0iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7QXV0aFVzZXJ9IGZyb20gJ0BsaWIvaW50ZXJmYWNlcyc7XG5cbmltcG9ydCB7Rm9yYmlkZGVuRXJyb3J9IGZyb20gJ2Fwb2xsby1zZXJ2ZXInO1xuaW1wb3J0IHt2YWxpZGF0ZUF1dGhlbnRpY2F0ZWRVc2VyfSBmcm9tICcuL3ZhbGlkYXRlLWF1dGhlbnRpY2F0ZWQtdXNlcic7XG5cbmV4cG9ydCBjb25zdCB2YWxpZGF0ZU93bmVyID0gKHVzZXI/OiBBdXRoVXNlcikgPT4gPFQgZXh0ZW5kcyB7Y3JlYXRlZEJ5Pzogc3RyaW5nfT4oZW50aXR5OiBUKTogVCA9PiB7XG4gIHZhbGlkYXRlQXV0aGVudGljYXRlZFVzZXIodXNlcik7XG4gIGlmIChlbnRpdHkuY3JlYXRlZEJ5ICYmIHVzZXIgJiYgdXNlci5pZCA9PT0gZW50aXR5LmNyZWF0ZWRCeSkge1xuICAgIHJldHVybiBlbnRpdHk7XG4gIH1cbiAgdGhyb3cgbmV3IEZvcmJpZGRlbkVycm9yKCdVc2VyIG11c3QgYmUgdGhlIG93bmVyJyk7XG59O1xuIl19
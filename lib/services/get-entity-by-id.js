"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getEntityById = void 0;

var _rxjs = require("rxjs");

var _operators = require("rxjs/operators");

var _helpers = require("../helpers");

const getEntityById = ({
  query,
  repository,
  validatePermission
}) => (0, _helpers.validateId)(query).pipe((0, _operators.switchMap)(repository.getById), (0, _operators.switchMap)(entity => validatePermission ? validatePermission(entity).pipe((0, _operators.map)(() => entity)) : (0, _rxjs.of)(entity)));

exports.getEntityById = getEntityById;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9zZXJ2aWNlcy9nZXQtZW50aXR5LWJ5LWlkLnRzIl0sIm5hbWVzIjpbImdldEVudGl0eUJ5SWQiLCJxdWVyeSIsInJlcG9zaXRvcnkiLCJ2YWxpZGF0ZVBlcm1pc3Npb24iLCJwaXBlIiwiZ2V0QnlJZCIsImVudGl0eSJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUdBOztBQUNBOztBQUNBOztBQUVPLE1BQU1BLGFBSU0sR0FBRyxDQUFDO0FBQUNDLEVBQUFBLEtBQUQ7QUFBUUMsRUFBQUEsVUFBUjtBQUFvQkMsRUFBQUE7QUFBcEIsQ0FBRCxLQUNwQix5QkFBK0JGLEtBQS9CLEVBQXNDRyxJQUF0QyxDQUNFLDBCQUFVRixVQUFVLENBQUNHLE9BQXJCLENBREYsRUFFRSwwQkFBV0MsTUFBRCxJQUFhSCxrQkFBa0IsR0FBR0Esa0JBQWtCLENBQUNHLE1BQUQsQ0FBbEIsQ0FBMkJGLElBQTNCLENBQWdDLG9CQUFJLE1BQU1FLE1BQVYsQ0FBaEMsQ0FBSCxHQUF3RCxjQUFHQSxNQUFILENBQWpHLENBRkYsQ0FMSyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHtPYnNlcnZhYmxlfSBmcm9tICdyeGpzJztcbmltcG9ydCB0eXBlIHtFbnRpdHksIEdldEJ5SWRRdWVyeSwgUmVhZFJlcG9zaXRvcnksIFdyaXRlUmVwb3NpdG9yeX0gZnJvbSAnQGxpYi9pbnRlcmZhY2VzJztcblxuaW1wb3J0IHtvZn0gZnJvbSAncnhqcyc7XG5pbXBvcnQge21hcCwgc3dpdGNoTWFwfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQge3ZhbGlkYXRlSWR9IGZyb20gJ0BsaWIvaGVscGVycyc7XG5cbmV4cG9ydCBjb25zdCBnZXRFbnRpdHlCeUlkOiA8SWQgPSBzdHJpbmcsIEUgZXh0ZW5kcyBFbnRpdHk8SWQ+ID0gRW50aXR5PElkPj4ocGFyYW1zOiB7XG4gIHF1ZXJ5OiBHZXRCeUlkUXVlcnk8SWQ+O1xuICByZXBvc2l0b3J5OiBSZWFkUmVwb3NpdG9yeTxJZCwgRT4gfCBXcml0ZVJlcG9zaXRvcnk8SWQsIEU+O1xuICB2YWxpZGF0ZVBlcm1pc3Npb24/OiAoZW50aXR5OiBFKSA9PiBPYnNlcnZhYmxlPHZvaWQ+O1xufSkgPT4gT2JzZXJ2YWJsZTxFPiA9ICh7cXVlcnksIHJlcG9zaXRvcnksIHZhbGlkYXRlUGVybWlzc2lvbn0pID0+XG4gIHZhbGlkYXRlSWQ8dHlwZW9mIHF1ZXJ5WydpZCddPihxdWVyeSkucGlwZShcbiAgICBzd2l0Y2hNYXAocmVwb3NpdG9yeS5nZXRCeUlkKSxcbiAgICBzd2l0Y2hNYXAoKGVudGl0eSkgPT4gKHZhbGlkYXRlUGVybWlzc2lvbiA/IHZhbGlkYXRlUGVybWlzc2lvbihlbnRpdHkpLnBpcGUobWFwKCgpID0+IGVudGl0eSkpIDogb2YoZW50aXR5KSkpLFxuICApO1xuIl19
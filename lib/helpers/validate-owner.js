"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.validateOwner = void 0;

var _apolloServer = require("apollo-server");

var _validateAuthenticatedUser = require("./validate-authenticated-user");

const validateOwner = user => entity => {
  (0, _validateAuthenticatedUser.validateAuthenticatedUser)(user);

  if (entity.createdBy && user.id === entity.createdBy) {
    return entity;
  }

  throw new _apolloServer.ForbiddenError('User must be the owner');
};

exports.validateOwner = validateOwner;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9oZWxwZXJzL3ZhbGlkYXRlLW93bmVyLnRzIl0sIm5hbWVzIjpbInZhbGlkYXRlT3duZXIiLCJ1c2VyIiwiZW50aXR5IiwiY3JlYXRlZEJ5IiwiaWQiLCJGb3JiaWRkZW5FcnJvciJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUVBOztBQUNBOztBQUVPLE1BQU1BLGFBQWEsR0FBSUMsSUFBRCxJQUFxREMsTUFBakMsSUFBa0Q7QUFDakcsNERBQTBCRCxJQUExQjs7QUFDQSxNQUFJQyxNQUFNLENBQUNDLFNBQVAsSUFBb0JGLElBQUksQ0FBQ0csRUFBTCxLQUFZRixNQUFNLENBQUNDLFNBQTNDLEVBQXNEO0FBQ3BELFdBQU9ELE1BQVA7QUFDRDs7QUFDRCxRQUFNLElBQUlHLDRCQUFKLENBQW1CLHdCQUFuQixDQUFOO0FBQ0QsQ0FOTSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHtBdXRoVXNlcn0gZnJvbSAnQGxpYi9pbnRlcmZhY2VzJztcblxuaW1wb3J0IHtGb3JiaWRkZW5FcnJvcn0gZnJvbSAnYXBvbGxvLXNlcnZlcic7XG5pbXBvcnQge3ZhbGlkYXRlQXV0aGVudGljYXRlZFVzZXJ9IGZyb20gJy4vdmFsaWRhdGUtYXV0aGVudGljYXRlZC11c2VyJztcblxuZXhwb3J0IGNvbnN0IHZhbGlkYXRlT3duZXIgPSAodXNlcjogQXV0aFVzZXIpID0+IDxUIGV4dGVuZHMge2NyZWF0ZWRCeT86IHN0cmluZ30+KGVudGl0eTogVCk6IFQgPT4ge1xuICB2YWxpZGF0ZUF1dGhlbnRpY2F0ZWRVc2VyKHVzZXIpO1xuICBpZiAoZW50aXR5LmNyZWF0ZWRCeSAmJiB1c2VyLmlkID09PSBlbnRpdHkuY3JlYXRlZEJ5KSB7XG4gICAgcmV0dXJuIGVudGl0eTtcbiAgfVxuICB0aHJvdyBuZXcgRm9yYmlkZGVuRXJyb3IoJ1VzZXIgbXVzdCBiZSB0aGUgb3duZXInKTtcbn07XG4iXX0=
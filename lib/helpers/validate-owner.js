"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.validateOwner = void 0;

var _errors = require("../errors");

var _validateAuthenticatedUser = require("./validate-authenticated-user");

const validateOwner = user => entity => {
  (0, _validateAuthenticatedUser.validateAuthenticatedUser)(user);

  if (entity.createdBy && user && user.id === entity.createdBy) {
    return entity;
  }

  throw new _errors.ForbiddenError('User must be the owner');
};

exports.validateOwner = validateOwner;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9oZWxwZXJzL3ZhbGlkYXRlLW93bmVyLnRzIl0sIm5hbWVzIjpbInZhbGlkYXRlT3duZXIiLCJ1c2VyIiwiZW50aXR5IiwiY3JlYXRlZEJ5IiwiaWQiLCJGb3JiaWRkZW5FcnJvciJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUVBOztBQUNBOztBQUVPLE1BQU1BLGFBQWEsR0FBSUMsSUFBRCxJQUFzREMsTUFBakMsSUFBa0Q7QUFDbEcsNERBQTBCRCxJQUExQjs7QUFDQSxNQUFJQyxNQUFNLENBQUNDLFNBQVAsSUFBb0JGLElBQXBCLElBQTRCQSxJQUFJLENBQUNHLEVBQUwsS0FBWUYsTUFBTSxDQUFDQyxTQUFuRCxFQUE4RDtBQUM1RCxXQUFPRCxNQUFQO0FBQ0Q7O0FBQ0QsUUFBTSxJQUFJRyxzQkFBSixDQUFtQix3QkFBbkIsQ0FBTjtBQUNELENBTk0iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7QXV0aFVzZXJ9IGZyb20gJ0BsaWIvaW50ZXJmYWNlcyc7XG5cbmltcG9ydCB7Rm9yYmlkZGVuRXJyb3J9IGZyb20gJ0BsaWIvZXJyb3JzJztcbmltcG9ydCB7dmFsaWRhdGVBdXRoZW50aWNhdGVkVXNlcn0gZnJvbSAnLi92YWxpZGF0ZS1hdXRoZW50aWNhdGVkLXVzZXInO1xuXG5leHBvcnQgY29uc3QgdmFsaWRhdGVPd25lciA9ICh1c2VyPzogQXV0aFVzZXIpID0+IDxUIGV4dGVuZHMge2NyZWF0ZWRCeT86IHN0cmluZ30+KGVudGl0eTogVCk6IFQgPT4ge1xuICB2YWxpZGF0ZUF1dGhlbnRpY2F0ZWRVc2VyKHVzZXIpO1xuICBpZiAoZW50aXR5LmNyZWF0ZWRCeSAmJiB1c2VyICYmIHVzZXIuaWQgPT09IGVudGl0eS5jcmVhdGVkQnkpIHtcbiAgICByZXR1cm4gZW50aXR5O1xuICB9XG4gIHRocm93IG5ldyBGb3JiaWRkZW5FcnJvcignVXNlciBtdXN0IGJlIHRoZSBvd25lcicpO1xufTtcbiJdfQ==
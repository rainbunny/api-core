"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.removeEntity = void 0;

var _rxjs = require("rxjs");

var _operators = require("rxjs/operators");

var _helpers = require("../helpers");

const removeEntity = ({
  id,
  repository,
  validatePermissions,
  fields
}) => repository.getById({
  id,
  fields: fields || {
    id: {},
    createdBy: {}
  }
}).pipe((0, _operators.map)(_helpers.validateEntityExist), (0, _operators.switchMap)(entity => validatePermissions ? validatePermissions(entity) : (0, _rxjs.of)(entity)), (0, _operators.switchMap)(entity => repository.remove(entity.id)));

exports.removeEntity = removeEntity;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9zZXJ2aWNlcy9yZW1vdmUtZW50aXR5LnRzIl0sIm5hbWVzIjpbInJlbW92ZUVudGl0eSIsImlkIiwicmVwb3NpdG9yeSIsInZhbGlkYXRlUGVybWlzc2lvbnMiLCJmaWVsZHMiLCJnZXRCeUlkIiwiY3JlYXRlZEJ5IiwicGlwZSIsInZhbGlkYXRlRW50aXR5RXhpc3QiLCJlbnRpdHkiLCJyZW1vdmUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFDQTs7QUFDQTs7QUFFQTs7QUFFTyxNQUFNQSxZQUtTLEdBQUcsQ0FBQztBQUFDQyxFQUFBQSxFQUFEO0FBQUtDLEVBQUFBLFVBQUw7QUFBaUJDLEVBQUFBLG1CQUFqQjtBQUFzQ0MsRUFBQUE7QUFBdEMsQ0FBRCxLQUN2QkYsVUFBVSxDQUFDRyxPQUFYLENBQW1CO0FBQUNKLEVBQUFBLEVBQUQ7QUFBS0csRUFBQUEsTUFBTSxFQUFFQSxNQUFNLElBQUk7QUFBQ0gsSUFBQUEsRUFBRSxFQUFFLEVBQUw7QUFBU0ssSUFBQUEsU0FBUyxFQUFFO0FBQXBCO0FBQXZCLENBQW5CLEVBQW9FQyxJQUFwRSxDQUNFLG9CQUFJQyw0QkFBSixDQURGLEVBRUUsMEJBQVdDLE1BQUQsSUFBYU4sbUJBQW1CLEdBQUdBLG1CQUFtQixDQUFDTSxNQUFELENBQXRCLEdBQWlDLGNBQUdBLE1BQUgsQ0FBM0UsQ0FGRixFQUdFLDBCQUFXQSxNQUFELElBQVlQLFVBQVUsQ0FBQ1EsTUFBWCxDQUFrQkQsTUFBTSxDQUFDUixFQUF6QixDQUF0QixDQUhGLENBTksiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7T2JzZXJ2YWJsZX0gZnJvbSAncnhqcyc7XG5pbXBvcnQge29mfSBmcm9tICdyeGpzJztcbmltcG9ydCB7bWFwLCBzd2l0Y2hNYXB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB0eXBlIHtFbnRpdHksIEZpZWxkcywgV3JpdGVSZXBvc2l0b3J5fSBmcm9tICcuLi9pbnRlcmZhY2VzJztcbmltcG9ydCB7dmFsaWRhdGVFbnRpdHlFeGlzdH0gZnJvbSAnLi4vaGVscGVycyc7XG5cbmV4cG9ydCBjb25zdCByZW1vdmVFbnRpdHk6IDxJZCA9IHN0cmluZywgRSBleHRlbmRzIEVudGl0eTxJZD4gPSBFbnRpdHk8SWQ+PihwYXJhbXM6IHtcbiAgaWQ6IElkO1xuICByZXBvc2l0b3J5OiBXcml0ZVJlcG9zaXRvcnk8SWQsIEU+O1xuICBmaWVsZHM/OiBGaWVsZHM7XG4gIHZhbGlkYXRlUGVybWlzc2lvbnM/OiAoZW50aXR5OiB7aWQ6IElkfSAmIFBhcnRpYWw8RT4pID0+IE9ic2VydmFibGU8e2lkOiBJZH0gJiBQYXJ0aWFsPEU+Pjtcbn0pID0+IE9ic2VydmFibGU8dm9pZD4gPSAoe2lkLCByZXBvc2l0b3J5LCB2YWxpZGF0ZVBlcm1pc3Npb25zLCBmaWVsZHN9KSA9PlxuICByZXBvc2l0b3J5LmdldEJ5SWQoe2lkLCBmaWVsZHM6IGZpZWxkcyB8fCB7aWQ6IHt9LCBjcmVhdGVkQnk6IHt9fX0pLnBpcGUoXG4gICAgbWFwKHZhbGlkYXRlRW50aXR5RXhpc3QpLFxuICAgIHN3aXRjaE1hcCgoZW50aXR5KSA9PiAodmFsaWRhdGVQZXJtaXNzaW9ucyA/IHZhbGlkYXRlUGVybWlzc2lvbnMoZW50aXR5KSA6IG9mKGVudGl0eSkpKSxcbiAgICBzd2l0Y2hNYXAoKGVudGl0eSkgPT4gcmVwb3NpdG9yeS5yZW1vdmUoZW50aXR5LmlkKSksXG4gICk7XG4iXX0=
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.createEntity = void 0;

var _rxjs = require("rxjs");

var _operators = require("rxjs/operators");

var _helpers = require("../helpers");

const createEntity = ({
  entity,
  repository,
  schema,
  validatePermissions
}) => (0, _helpers.validateSchema)(schema)(entity).pipe((0, _operators.switchMap)(e => validatePermissions ? validatePermissions(e).pipe((0, _operators.map)(() => e)) : (0, _rxjs.of)(e)), (0, _operators.switchMap)(repository.create));

exports.createEntity = createEntity;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9zZXJ2aWNlcy9jcmVhdGUtZW50aXR5LnRzIl0sIm5hbWVzIjpbImNyZWF0ZUVudGl0eSIsImVudGl0eSIsInJlcG9zaXRvcnkiLCJzY2hlbWEiLCJ2YWxpZGF0ZVBlcm1pc3Npb25zIiwicGlwZSIsImUiLCJjcmVhdGUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFFQTs7QUFDQTs7QUFFQTs7QUFFTyxNQUFNQSxZQUtPLEdBQUcsQ0FBQztBQUFDQyxFQUFBQSxNQUFEO0FBQVNDLEVBQUFBLFVBQVQ7QUFBcUJDLEVBQUFBLE1BQXJCO0FBQTZCQyxFQUFBQTtBQUE3QixDQUFELEtBQ3JCLDZCQUE4QkQsTUFBOUIsRUFBc0NGLE1BQXRDLEVBQThDSSxJQUE5QyxDQUNFLDBCQUFXQyxDQUFELElBQVFGLG1CQUFtQixHQUFHQSxtQkFBbUIsQ0FBQ0UsQ0FBRCxDQUFuQixDQUF1QkQsSUFBdkIsQ0FBNEIsb0JBQUksTUFBTUMsQ0FBVixDQUE1QixDQUFILEdBQStDLGNBQUdBLENBQUgsQ0FBcEYsQ0FERixFQUVFLDBCQUFVSixVQUFVLENBQUNLLE1BQXJCLENBRkYsQ0FOSyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHtPYnNlcnZhYmxlfSBmcm9tICdyeGpzJztcbmltcG9ydCB0eXBlIHtTY2hlbWFPZn0gZnJvbSAneXVwJztcbmltcG9ydCB7b2Z9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHtzd2l0Y2hNYXAsIG1hcH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHR5cGUge0VudGl0eSwgV3JpdGVSZXBvc2l0b3J5fSBmcm9tICcuLi9pbnRlcmZhY2VzJztcbmltcG9ydCB7dmFsaWRhdGVTY2hlbWF9IGZyb20gJy4uL2hlbHBlcnMnO1xuXG5leHBvcnQgY29uc3QgY3JlYXRlRW50aXR5OiA8SWQgPSBzdHJpbmcsIEUgZXh0ZW5kcyBFbnRpdHk8SWQ+ID0gRW50aXR5PElkPj4ocGFyYW1zOiB7XG4gIGVudGl0eTogT21pdDxFLCAnaWQnPiAmIHtpZD86IElkfTtcbiAgcmVwb3NpdG9yeTogV3JpdGVSZXBvc2l0b3J5PElkLCBFPjtcbiAgc2NoZW1hOiBTY2hlbWFPZjx1bmtub3duPjtcbiAgdmFsaWRhdGVQZXJtaXNzaW9ucz86IChlbnRpdHk6IE9taXQ8RSwgJ2lkJz4gJiB7aWQ/OiBJZH0pID0+IE9ic2VydmFibGU8dm9pZD47XG59KSA9PiBPYnNlcnZhYmxlPElkPiA9ICh7ZW50aXR5LCByZXBvc2l0b3J5LCBzY2hlbWEsIHZhbGlkYXRlUGVybWlzc2lvbnN9KSA9PlxuICB2YWxpZGF0ZVNjaGVtYTx0eXBlb2YgZW50aXR5PihzY2hlbWEpKGVudGl0eSkucGlwZShcbiAgICBzd2l0Y2hNYXAoKGUpID0+ICh2YWxpZGF0ZVBlcm1pc3Npb25zID8gdmFsaWRhdGVQZXJtaXNzaW9ucyhlKS5waXBlKG1hcCgoKSA9PiBlKSkgOiBvZihlKSkpLFxuICAgIHN3aXRjaE1hcChyZXBvc2l0b3J5LmNyZWF0ZSksXG4gICk7XG4iXX0=
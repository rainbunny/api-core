"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.removeEntity = void 0;

var _rxjs = require("rxjs");

var _operators = require("rxjs/operators");

var _helpers = require("../helpers");

const removeEntity = ({
  id,
  repository,
  validatePermission,
  fields
}) => repository.getById({
  id,
  fields: fields || {
    id: {},
    createdBy: {}
  }
}).pipe((0, _operators.map)(_helpers.validateEntityExist), (0, _operators.switchMap)(entity => validatePermission ? validatePermission(entity) : (0, _rxjs.of)(entity)), (0, _operators.switchMap)(entity => repository.remove(entity.id)));

exports.removeEntity = removeEntity;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9zZXJ2aWNlcy9yZW1vdmUtZW50aXR5LnRzIl0sIm5hbWVzIjpbInJlbW92ZUVudGl0eSIsImlkIiwicmVwb3NpdG9yeSIsInZhbGlkYXRlUGVybWlzc2lvbiIsImZpZWxkcyIsImdldEJ5SWQiLCJjcmVhdGVkQnkiLCJwaXBlIiwidmFsaWRhdGVFbnRpdHlFeGlzdCIsImVudGl0eSIsInJlbW92ZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUdBOztBQUNBOztBQUNBOztBQUVPLE1BQU1BLFlBS1MsR0FBRyxDQUFDO0FBQUNDLEVBQUFBLEVBQUQ7QUFBS0MsRUFBQUEsVUFBTDtBQUFpQkMsRUFBQUEsa0JBQWpCO0FBQXFDQyxFQUFBQTtBQUFyQyxDQUFELEtBQ3ZCRixVQUFVLENBQUNHLE9BQVgsQ0FBbUI7QUFBQ0osRUFBQUEsRUFBRDtBQUFLRyxFQUFBQSxNQUFNLEVBQUVBLE1BQU0sSUFBSTtBQUFDSCxJQUFBQSxFQUFFLEVBQUUsRUFBTDtBQUFTSyxJQUFBQSxTQUFTLEVBQUU7QUFBcEI7QUFBdkIsQ0FBbkIsRUFBb0VDLElBQXBFLENBQ0Usb0JBQUlDLDRCQUFKLENBREYsRUFFRSwwQkFBV0MsTUFBRCxJQUFhTixrQkFBa0IsR0FBR0Esa0JBQWtCLENBQUNNLE1BQUQsQ0FBckIsR0FBZ0MsY0FBR0EsTUFBSCxDQUF6RSxDQUZGLEVBR0UsMEJBQVdBLE1BQUQsSUFBWVAsVUFBVSxDQUFDUSxNQUFYLENBQWtCRCxNQUFNLENBQUNSLEVBQXpCLENBQXRCLENBSEYsQ0FOSyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHtPYnNlcnZhYmxlfSBmcm9tICdyeGpzJztcbmltcG9ydCB0eXBlIHtFbnRpdHksIEZpZWxkcywgV3JpdGVSZXBvc2l0b3J5fSBmcm9tICdAbGliL2ludGVyZmFjZXMnO1xuXG5pbXBvcnQge29mfSBmcm9tICdyeGpzJztcbmltcG9ydCB7bWFwLCBzd2l0Y2hNYXB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7dmFsaWRhdGVFbnRpdHlFeGlzdH0gZnJvbSAnQGxpYi9oZWxwZXJzJztcblxuZXhwb3J0IGNvbnN0IHJlbW92ZUVudGl0eTogPElkID0gc3RyaW5nLCBFIGV4dGVuZHMgRW50aXR5PElkPiA9IEVudGl0eTxJZD4+KHBhcmFtczoge1xuICBpZDogSWQ7XG4gIHJlcG9zaXRvcnk6IFdyaXRlUmVwb3NpdG9yeTxJZCwgRT47XG4gIGZpZWxkcz86IEZpZWxkcztcbiAgdmFsaWRhdGVQZXJtaXNzaW9uPzogKGVudGl0eToge2lkOiBJZH0gJiBQYXJ0aWFsPEU+KSA9PiBPYnNlcnZhYmxlPHtpZDogSWR9ICYgUGFydGlhbDxFPj47XG59KSA9PiBPYnNlcnZhYmxlPHZvaWQ+ID0gKHtpZCwgcmVwb3NpdG9yeSwgdmFsaWRhdGVQZXJtaXNzaW9uLCBmaWVsZHN9KSA9PlxuICByZXBvc2l0b3J5LmdldEJ5SWQoe2lkLCBmaWVsZHM6IGZpZWxkcyB8fCB7aWQ6IHt9LCBjcmVhdGVkQnk6IHt9fX0pLnBpcGUoXG4gICAgbWFwKHZhbGlkYXRlRW50aXR5RXhpc3QpLFxuICAgIHN3aXRjaE1hcCgoZW50aXR5KSA9PiAodmFsaWRhdGVQZXJtaXNzaW9uID8gdmFsaWRhdGVQZXJtaXNzaW9uKGVudGl0eSkgOiBvZihlbnRpdHkpKSksXG4gICAgc3dpdGNoTWFwKChlbnRpdHkpID0+IHJlcG9zaXRvcnkucmVtb3ZlKGVudGl0eS5pZCkpLFxuICApO1xuIl19
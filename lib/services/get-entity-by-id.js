"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getEntityById = void 0;

var _rxjs = require("rxjs");

var _operators = require("rxjs/operators");

var _helpers = require("../helpers");

const getEntityById = ({
  query,
  repository,
  validatePermissions
}) => (0, _helpers.validateId)(query).pipe((0, _operators.switchMap)(repository.getById), (0, _operators.switchMap)(entity => validatePermissions ? validatePermissions(entity).pipe((0, _operators.map)(() => entity)) : (0, _rxjs.of)(entity)));

exports.getEntityById = getEntityById;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9zZXJ2aWNlcy9nZXQtZW50aXR5LWJ5LWlkLnRzIl0sIm5hbWVzIjpbImdldEVudGl0eUJ5SWQiLCJxdWVyeSIsInJlcG9zaXRvcnkiLCJ2YWxpZGF0ZVBlcm1pc3Npb25zIiwicGlwZSIsImdldEJ5SWQiLCJlbnRpdHkiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFHQTs7QUFDQTs7QUFDQTs7QUFFTyxNQUFNQSxhQUlNLEdBQUcsQ0FBQztBQUFDQyxFQUFBQSxLQUFEO0FBQVFDLEVBQUFBLFVBQVI7QUFBb0JDLEVBQUFBO0FBQXBCLENBQUQsS0FDcEIseUJBQStCRixLQUEvQixFQUFzQ0csSUFBdEMsQ0FDRSwwQkFBVUYsVUFBVSxDQUFDRyxPQUFyQixDQURGLEVBRUUsMEJBQVdDLE1BQUQsSUFBYUgsbUJBQW1CLEdBQUdBLG1CQUFtQixDQUFDRyxNQUFELENBQW5CLENBQTRCRixJQUE1QixDQUFpQyxvQkFBSSxNQUFNRSxNQUFWLENBQWpDLENBQUgsR0FBeUQsY0FBR0EsTUFBSCxDQUFuRyxDQUZGLENBTEsiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7T2JzZXJ2YWJsZX0gZnJvbSAncnhqcyc7XG5pbXBvcnQgdHlwZSB7RW50aXR5LCBHZXRCeUlkUXVlcnksIFJlYWRSZXBvc2l0b3J5LCBXcml0ZVJlcG9zaXRvcnl9IGZyb20gJ0BsaWIvaW50ZXJmYWNlcyc7XG5cbmltcG9ydCB7b2Z9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHttYXAsIHN3aXRjaE1hcH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHt2YWxpZGF0ZUlkfSBmcm9tICdAbGliL2hlbHBlcnMnO1xuXG5leHBvcnQgY29uc3QgZ2V0RW50aXR5QnlJZDogPElkID0gc3RyaW5nLCBFIGV4dGVuZHMgRW50aXR5PElkPiA9IEVudGl0eTxJZD4+KHBhcmFtczoge1xuICBxdWVyeTogR2V0QnlJZFF1ZXJ5PElkPjtcbiAgcmVwb3NpdG9yeTogUmVhZFJlcG9zaXRvcnk8SWQsIEU+IHwgV3JpdGVSZXBvc2l0b3J5PElkLCBFPjtcbiAgdmFsaWRhdGVQZXJtaXNzaW9ucz86IChlbnRpdHk6IEUpID0+IE9ic2VydmFibGU8dm9pZD47XG59KSA9PiBPYnNlcnZhYmxlPEU+ID0gKHtxdWVyeSwgcmVwb3NpdG9yeSwgdmFsaWRhdGVQZXJtaXNzaW9uc30pID0+XG4gIHZhbGlkYXRlSWQ8dHlwZW9mIHF1ZXJ5WydpZCddPihxdWVyeSkucGlwZShcbiAgICBzd2l0Y2hNYXAocmVwb3NpdG9yeS5nZXRCeUlkKSxcbiAgICBzd2l0Y2hNYXAoKGVudGl0eSkgPT4gKHZhbGlkYXRlUGVybWlzc2lvbnMgPyB2YWxpZGF0ZVBlcm1pc3Npb25zKGVudGl0eSkucGlwZShtYXAoKCkgPT4gZW50aXR5KSkgOiBvZihlbnRpdHkpKSksXG4gICk7XG4iXX0=
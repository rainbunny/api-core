"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.removeEntity = void 0;

var _rxjs = require("rxjs");

var _operators = require("rxjs/operators");

var _helpers = require("../helpers");

const removeEntity = ({
  id,
  repository,
  validatePermission,
  fields
}) => repository.getById({
  id,
  fields: fields || {
    id: {},
    createdBy: {}
  }
}).pipe((0, _operators.map)(_helpers.validateEntityExist), (0, _operators.switchMap)(entity => validatePermission ? validatePermission(entity) : (0, _rxjs.of)(entity)), (0, _operators.map)(() => id), (0, _operators.switchMap)(repository.remove));

exports.removeEntity = removeEntity;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9zZXJ2aWNlcy9yZW1vdmUtZW50aXR5LnRzIl0sIm5hbWVzIjpbInJlbW92ZUVudGl0eSIsImlkIiwicmVwb3NpdG9yeSIsInZhbGlkYXRlUGVybWlzc2lvbiIsImZpZWxkcyIsImdldEJ5SWQiLCJjcmVhdGVkQnkiLCJwaXBlIiwidmFsaWRhdGVFbnRpdHlFeGlzdCIsImVudGl0eSIsInJlbW92ZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUdBOztBQUNBOztBQUNBOztBQUVPLE1BQU1BLFlBS1MsR0FBRyxDQUFDO0FBQUNDLEVBQUFBLEVBQUQ7QUFBS0MsRUFBQUEsVUFBTDtBQUFpQkMsRUFBQUEsa0JBQWpCO0FBQXFDQyxFQUFBQTtBQUFyQyxDQUFELEtBQ3ZCRixVQUFVLENBQUNHLE9BQVgsQ0FBbUI7QUFBQ0osRUFBQUEsRUFBRDtBQUFLRyxFQUFBQSxNQUFNLEVBQUVBLE1BQU0sSUFBSTtBQUFDSCxJQUFBQSxFQUFFLEVBQUUsRUFBTDtBQUFTSyxJQUFBQSxTQUFTLEVBQUU7QUFBcEI7QUFBdkIsQ0FBbkIsRUFBb0VDLElBQXBFLENBQ0Usb0JBQUlDLDRCQUFKLENBREYsRUFFRSwwQkFBV0MsTUFBRCxJQUFhTixrQkFBa0IsR0FBR0Esa0JBQWtCLENBQUNNLE1BQUQsQ0FBckIsR0FBZ0MsY0FBR0EsTUFBSCxDQUF6RSxDQUZGLEVBR0Usb0JBQUksTUFBTVIsRUFBVixDQUhGLEVBSUUsMEJBQVVDLFVBQVUsQ0FBQ1EsTUFBckIsQ0FKRixDQU5LIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUge09ic2VydmFibGV9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHR5cGUge0VudGl0eSwgRmllbGRzLCBXcml0ZVJlcG9zaXRvcnl9IGZyb20gJ0BsaWIvaW50ZXJmYWNlcyc7XG5cbmltcG9ydCB7b2Z9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHttYXAsIHN3aXRjaE1hcH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHt2YWxpZGF0ZUVudGl0eUV4aXN0fSBmcm9tICdAbGliL2hlbHBlcnMnO1xuXG5leHBvcnQgY29uc3QgcmVtb3ZlRW50aXR5OiA8SWQgPSBzdHJpbmcsIEUgZXh0ZW5kcyBFbnRpdHk8SWQ+ID0gRW50aXR5PElkPj4ocGFyYW1zOiB7XG4gIGlkOiBJZDtcbiAgcmVwb3NpdG9yeTogV3JpdGVSZXBvc2l0b3J5PElkLCBFPjtcbiAgdmFsaWRhdGVQZXJtaXNzaW9uPzogKGVudGl0eToge2lkOiBJZH0gJiBQYXJ0aWFsPEU+KSA9PiBPYnNlcnZhYmxlPHtpZDogSWR9ICYgUGFydGlhbDxFPj47XG4gIGZpZWxkcz86IEZpZWxkcztcbn0pID0+IE9ic2VydmFibGU8dm9pZD4gPSAoe2lkLCByZXBvc2l0b3J5LCB2YWxpZGF0ZVBlcm1pc3Npb24sIGZpZWxkc30pID0+XG4gIHJlcG9zaXRvcnkuZ2V0QnlJZCh7aWQsIGZpZWxkczogZmllbGRzIHx8IHtpZDoge30sIGNyZWF0ZWRCeToge319fSkucGlwZShcbiAgICBtYXAodmFsaWRhdGVFbnRpdHlFeGlzdCksXG4gICAgc3dpdGNoTWFwKChlbnRpdHkpID0+ICh2YWxpZGF0ZVBlcm1pc3Npb24gPyB2YWxpZGF0ZVBlcm1pc3Npb24oZW50aXR5KSA6IG9mKGVudGl0eSkpKSxcbiAgICBtYXAoKCkgPT4gaWQpLFxuICAgIHN3aXRjaE1hcChyZXBvc2l0b3J5LnJlbW92ZSksXG4gICk7XG4iXX0=